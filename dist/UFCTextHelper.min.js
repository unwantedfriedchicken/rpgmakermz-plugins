var Imported=Imported||{};Imported.UFCTextHelper=!0;var UFC=UFC||{};function Text_UFCTextHelper(){this.initialize(...arguments)}function Text_UFCContainer(){this.initialize(...arguments)}function TextHelper(){}UFC.TH=UFC.TH||{},UFC.TH.VERSION=1,UFC.TH.ALIAS=UFC.TH.ALIAS||{},UFC.TH.PARAMETERS=PluginManager.parameters("UFCTextHelper"),UFC.TH.CONFIG={DEFAULT:{color:UFC.TH.PARAMETERS.defaultColor,size:+UFC.TH.PARAMETERS.defaultSize}},Text_UFCTextHelper.prototype=Object.create(PIXI.Text.prototype),Text_UFCTextHelper.prototype.constructor=Text_UFCTextHelper,Text_UFCTextHelper.prototype.initialize=function(t,e,i,a={},n=null){a.style||(a.style={});let r={fontFamily:a.style.fontFamily||$gameSystem.mainFontFace(),fontSize:a.style.fontSize||UFC.TH.CONFIG.DEFAULT.size,fill:a.style.fill||UFC.TH.CONFIG.DEFAULT.color,align:a.style.align||"center",stroke:a.style.stroke||"#000000",strokeThickness:a.style.strokeThickness||3};PIXI.Text.call(this,t,r),this._x=e||0,this._y=i||0,this.z=20,this.anchor.set(.5),this.scale.set(0),a.animate||(a.animate={}),this._animate={start:a.animate.start||!1,time:a.animate.time||60,timeMax:a.animate.time||60,timeScale:a.animate.time/6||60,timeScaleMax:a.animate.time/6||60,randomX:a.animate.randomX||!0,destroy:a.animate.destroy||!0},this._animate.randomX&&(this._x+=.4*Math.random()-.2),n&&n.addChild(this),this.x=this.screenX(),this.y=this.screenY()},Text_UFCTextHelper.prototype.update=function(){this.updateAnimation()},Text_UFCTextHelper.prototype.updateAnimation=function(){if(!this._animate||!this._animate.start)return;if(this._animate.time--,this._animate.time<=0)return this._animate.start=!1,void(this._animate.destroy&&this.destroy());this.y=this.screenY()+(this._animate.timeMax-this._animate.time)/this._animate.timeMax*-50;let t=this._animate.timeMax/2;if(this._animate.time<=t&&(this.alpha=this._animate.time/t),this._animate.timeScale<0)return;let e=this._animate.timeScale/this._animate.timeScaleMax;this.scale.set(1+1.3*e),this._animate.timeScale--},Text_UFCTextHelper.prototype.screenX=function(){return this._x*$gameMap.tileWidth()},Text_UFCTextHelper.prototype.screenY=function(){return this._y*$gameMap.tileHeight()},Text_UFCTextHelper.prototype.destroy=function(){Sprite.prototype.destroy.call(this,{texture:!0,baseTexture:!0})},Text_UFCContainer.prototype=Object.create(PIXI.Container.prototype),Text_UFCContainer.prototype.constructor=Text_UFCContainer,Text_UFCContainer.prototype.initialize=function(){PIXI.Container.call(this,...arguments),this._x=0,this._y=0,this.z=20},Text_UFCContainer.prototype.update=function(){this.x=this.screenX(this._x),this.y=this.screenY(this._y);for(const t of this.children)t.update&&t.update()},Text_UFCContainer.prototype.screenX=function(t){const e=$gameMap.tileWidth();return Math.floor($gameMap.adjustX(t)*e+e/2)},Text_UFCContainer.prototype.screenY=function(t){const e=$gameMap.tileHeight();return Math.floor($gameMap.adjustY(t)*e+e/2)},Text_UFCContainer.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t||{children:!0,texture:!0,baseTexture:!0})},TextHelper.initialize=function(){},TextHelper.spawnText=function(t,e,i,a){let n=new Text_UFCTextHelper(t,e,i,a);return this.textContainer.addChild(n),n},TextHelper.initTextContainer=function(){return this.textContainer&&!this.textContainer._destroyed||(this.textContainer=new Text_UFCContainer),this.textContainer},UFC.TH.ALIAS.Spriteset_Map_createCharacters=Spriteset_Map.prototype.createCharacters,Spriteset_Map.prototype.createCharacters=function(){UFC.TH.ALIAS.Spriteset_Map_createCharacters.call(this),this._tilemap.addChild(TextHelper.initTextContainer())};